// src/app/(portfolio)/[variant]/_components/StretchyGraphicSection/PerpetualText.tsx

"use client";

import { motion, useTransform, type MotionValue } from 'motion/react';

type PerpetualTextProps = {
  scrollYProgress: MotionValue<number>;
};

export const PerpetualText = ({ scrollYProgress }: PerpetualTextProps) => {
  // HOOK IS NOW HERE: Called at the top level of the component.
  // Animates from 0% to 100% during the first half of the scroll.
  const animatedHeight = useTransform(scrollYProgress, [0, 0.5], ['0%', '100%'], { clamp: true });

  return (
    <motion.div style={{ height: animatedHeight }}>
      <svg
        width="100%"
        height="100%"
        viewBox="0 0 1664 313"
        preserveAspectRatio="none"
        fill="currentColor"
        xmlns="http://www.w.org/2000/svg"
      >
        {/* SVG path data... */}
        <path d="M0 309.135V0H58.8311C81.1651 0 99.7768 3.78533 114.666 11.356C129.737 18.9266 140.995 29.6517 148.44 43.5313C155.884 57.4108 159.607 73.7438 159.607 92.5303C159.607 111.317 155.703 127.51 147.895 141.109C140.087 154.708 128.648 165.363 113.577 173.074C98.6874 180.644 80.4388 184.78 58.8311 185.481V309.135H0ZM58.8311 139.216C69.181 139.216 77.352 137.674 83.3441 134.59C89.3361 131.365 93.6032 126.318 96.1453 119.448C98.8689 112.579 100.231 103.746 100.231 92.9509C100.231 82.0155 98.8689 73.1129 96.1453 66.2433C93.6032 59.3736 89.2453 54.3265 83.0717 51.1019C77.0796 47.8774 68.9994 46.2651 58.8311 46.2651V139.216Z" />
        <path d="M191.507 309.135V0H326.056V46.6857H250.339V129.963H304.812V175.387H250.339V262.45H326.056V309.135H191.507Z" />
        <path d="M369.716 309.135V0H428.547C463.773 0 489.739 7.57065 506.444 22.712C523.149 37.7131 531.501 59.8643 531.501 89.1655C531.501 106.55 527.507 121.621 519.517 134.379C511.709 146.997 502.177 156.25 490.919 162.138L530.957 309.135H472.126L438.897 178.752H428.547V309.135H369.716ZM428.547 136.692C439.442 136.692 448.067 134.87 454.422 131.225C460.777 127.439 465.316 122.112 468.04 115.242C470.764 108.373 472.126 100.241 472.126 90.8479C472.126 76.1272 468.948 64.8413 462.593 56.9902C456.419 48.999 445.07 45.0034 428.547 45.0034V136.692Z" />
        <path d="M564.415 309.135V0H623.246C645.58 0 664.192 3.78533 679.081 11.356C694.152 18.9266 705.41 29.6517 712.855 43.5313C720.299 57.4108 724.022 73.7438 724.022 92.5303C724.022 111.317 720.118 127.51 712.31 141.109C704.502 154.708 693.063 165.363 677.992 173.074C663.102 180.644 644.854 184.78 623.246 185.481V247.308V309.135H564.415ZM623.246 139.216C633.596 139.216 641.767 137.674 647.759 134.59C653.751 131.365 658.018 126.318 660.56 119.448C663.284 112.579 664.646 103.746 664.646 92.9509C664.646 82.0155 663.284 73.1129 660.56 66.2433C658.018 59.3736 653.66 54.3265 647.487 51.1019C641.495 47.8774 633.414 46.2651 623.246 46.2651V139.216Z" />
        <path d="M755.923 309.135V0H890.471V46.6857H814.754V129.963H869.227V175.387H814.754V262.45H890.471V309.135H755.923Z" />
        <path d="M973.352 309.135V46.6857H917.789V0H1087.75V46.6857H1032.18V309.135H973.352Z" />
        <path d="M1193.44 312.5C1176.92 312.5 1162.75 309.556 1150.95 303.668C1139.33 297.779 1130.43 289.788 1124.26 279.694C1118.09 269.6 1115 258.244 1115 245.626V0H1173.83V245.626C1173.83 251.654 1175.37 256.982 1178.46 261.608C1181.55 266.095 1186.54 268.338 1193.44 268.338C1200.7 268.338 1205.79 266.095 1208.69 261.608C1211.6 256.982 1213.05 251.654 1213.05 245.626V0H1271.88V245.626C1271.88 258.244 1268.7 269.6 1262.35 279.694C1256.18 289.788 1247.19 297.779 1235.38 303.668C1223.76 309.556 1209.78 312.5 1193.44 312.5Z" />
        <path d="M1303.29 309.135L1363.76 0H1435.66L1496.13 309.135H1438.93L1428.04 246.046H1371.39L1360.49 309.135H1303.29ZM1379.56 198.099H1419.87L1402.98 94.2126L1401.35 77.8095H1398.08L1396.44 94.2126L1379.56 198.099Z" />
        <path d="M1527.27 309.135V0H1586.1V267.076H1664V309.135H1527.27Z" />
      </svg>
    </motion.div>
  );
};